[TOC]
## EXT2文件系统  
- data block 用来放置文件内容数据的地方.在EXT2文件系统中支持block大小有1k 2k 4k.  

	> 每个block大小在与数量在格式化完成后就确定,不能再改变了.
	> 每个block最多只能放一个文件
	> 如果文件大于block大小,那文件会占用多个block
	> 如果文件大小小于block,那么剩余容量就不能再使用了(磁盘空间会浪费).
	
- inode table  
 
	- 记录内容:  
	> 该文件的存取模式（read/write/excute）
	> 该文件的拥有者与群组（owner/group）
	> 该文件的容量
	> 该文件创建或状态改变的时间（ctime） 
	> “最近一次的读取时间（atime）
	> 最近修改的时间（mtime）
	> 定义文件特性的旗标（flag），如 SetUID...
	> 该文件真正内容的指向 （pointer）
	
	- 特点:  
	> 每个 inode 大小均固定为 128 Bytes（新的 ext4 与 xfs 可设置到 		256 Bytes）
	> 每个文件都仅会占用一个 inode 而已
	> 承上，因此文件系统能够创建的文件数量与 inode 的数量有关
	> 系统读取文件时需要先找到 inode，并分析 inode 所记录的权限与使用		者是否符合，若符合才能够开始实际读取 block 的内容。  
	
	![inode结构示意图](img/QQ20180109-160713@2x.png)
	
	***inode要记录的数据特别多,而只有128Bytes.inode记录一个block号码要4Byte,所以大文件一个inode肯定是不够用的.为此,inode记录block号码区域定义了12个直接,一个间接,一个双间接,一个三间接记录区.***  
	
	>如上图,最左边为 inode 本身 （128 Bytes），里面有 12 个直接指向 block 号码的对照，这 12 笔记录就能够直接取得 block 号码啦！ 至于所谓的间接就是再拿一个 block 来当作记录 block 号码的记录区，如果文件太大时， 就会使用间接的 block 来记录号码。如上图 7.1.4 当中间接只是拿一个 block 来记录额外的号码而已。 同理，如果文件持续长大，那么就会利用所谓的双间接，第一个 block 仅再指出下一个记录号码的 block 在哪里， 实际记录的在第二个 block 当中。依此类推，三间接就是利用第三层 block 来记录号码啦！
	
	```
	inode指定block大小计算(block为1k):
	- 12 个直接指向： 12*1K=12K
		  由于是直接,12所以总共可以记录12笔
	- 1  个间接： 256*1K=256K
		  每笔 block 号码的记录会花去 4Bytes，因此 1K 的大小能够记录 256 笔记录
	- 1  个双间接: 256*256*1K=2562K
		  第一层 block 会指定256个第二层,每个第二层可以指定 256个号码
	- 1  个三间接： 256*256*256*1K=2563K
		  第一层 block 会指定256个第二层,每个第二层可以指定256个第三层，每个第三层可以指定 256 个号码
	得到:12 + 256 + 256*256 + 256*256*256 （K） = 16GB
	
	上面方法不能用在2k及4k block大小计算中,因为大于2k block将会受到EXT2文件系统本身的限制,所以计算结果会不太符合之故.
	```  
	
- super block 记录整个文件系统信息,没有它就没有文件系统  
	- 记录信息  
	> block 与 inode 的总量
	> 未使用与已使用的 inode / block 数量
 	> block 与 inode 的大小（block为1,2,4K,inode为 128Bytes或 256Bytes）
	> filesystem 的挂载时间、最近一次写入数据的时间、最近一次检验磁盘 （fsck） 的时间等文件系统的相关信息
	> 一个 valid bit 数值，若此文件系统已被挂载，则 valid bit 为 0 ，若未被挂载，则 valid bit 为 1
	
	- 


